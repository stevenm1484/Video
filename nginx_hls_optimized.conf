
# Add this to your nginx configuration for better HLS streaming
location /streams/ {
    # HLS streaming optimizations
    add_header Cache-Control no-cache;
    add_header Access-Control-Allow-Origin *;
    add_header Access-Control-Allow-Headers "Range";
    add_header Access-Control-Allow-Methods "GET, HEAD, OPTIONS";
    
    # Disable buffering for live streams
    proxy_buffering off;
    proxy_cache off;
    
    # Set proper MIME types
    location ~* \.m3u8$ {
        add_header Content-Type application/vnd.apple.mpegurl;
        add_header Cache-Control no-cache;
    }
    
    location ~* \.ts$ {
        add_header Content-Type video/mp2t;
        add_header Cache-Control no-cache;
    }
    
    # CORS headers
    if ($request_method = 'OPTIONS') {
        add_header Access-Control-Allow-Origin *;
        add_header Access-Control-Allow-Methods "GET, HEAD, OPTIONS";
        add_header Access-Control-Allow-Headers "Range";
        add_header Access-Control-Max-Age 86400;
        add_header Content-Length 0;
        add_header Content-Type text/plain;
        return 204;
    }
}
